<!DOCTYPE html>
<html ng-app="app">
<head>
<!-- Title -->
    	<title>Firebase AngularJS Demo</title>
<!-- meta data -->
	<meta charset="utf-8">
    	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- AngularJS -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
<!-- Firebase -->
	<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
<!-- AngularFire -->
	<script src="https://cdn.firebase.com/libs/angularfire/1.1.2/angularfire.min.js"></script>
<!-- BootStrap -->
	<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<!-- jQuery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<!-- Latest compiled JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
<!-- Angular app -->
	<script>
		var app = angular.module("app", ["firebase"]);
		app.controller("RootCtrl", function($scope, $firebaseArray) {
		
		// Variables for example
		$scope.newRFP = {}
            	$scope.newTotal = {}
		$scope.lockName = false;
		// Set database path references for RFPs
			var RFPS = new Firebase("https://rfpcounter.firebaseio.com/RFPs");
		// Bind (three-way)
			$scope.rfps = $firebaseArray(RFPS);
			
            	// Set database path references for Totals
            		var TOTALS = new Firebase("https://rfpcounter.firebaseio.com/Totals");
            	// Bind (three-way)
			$scope.totals = $firebaseArray(TOTALS);
			
		// Add new chat message
		$scope.send = function(){

				// Add it to firebase db (and let the magic happen)
				$scope.rfps.$add( $scope.newRFP );
                $scope.totals.$add( $scope.newTotal );
				//Reset msg
				$scope.newRFP.tenTillEleven = '';
                $scope.newRFP.elevenTillTwelve = '';
				//Lock name for this session
				$scope.lockName = true;
			}
            
            /*
            var updateRef = new Firebase('https://rfpcounter.firebaseio.com/Totals/10-11');
            updateRef.update({
            value: 1
            });
           */ 
            
            // Update Function
            var updateRef = new Firebase('https://rfpcounter.firebaseio.com/Totals/');
            
            $scope.update = function(){
                
            updateRef.update({
            value: $scope.newTotal.tenTillEleven
            });
                
            }
		});
	</script>
</head>
<body ng-controller="RootCtrl">
	<div ng-repeat="chat in chats"><strong>{{chat.username}}</strong>({{chat.time | date: 'dd-MM-yyyy HH:mm:ss'}}): {{chat.msg}}</div>
	<div>
		<input ng-model="newRFP.username" placeholder="Your name" ng-disabled="lockName" />
	</div>
	<div>
		<input ng-model="newRFP.tenTillEleven" placeholder="10" />
        <input ng-model="newRFP.elevenTillTwelve" placeholder="12" />
        <input ng-model="newTotal.total" placeholder="0" />
		<button ng-disabled="!newRFP.tenTillEleven || !newRFP.tenTillEleven || !newTotal.total || !newRFP.username" ng-click="send()">Send</button>
        <button ng-click="update()">Update</button>
	</div>
    
    <div ng-repeat="rfp in rfps">
    
        <h1>10-11: {{rfp.tenTillEleven}}</h1>
        <br>
        <h1>11-12: {{rfp.elevenTillTwelve}}</h1>
    
    </div>
</body>
</html>
