<!DOCTYPE html>
<html ng-app="app">
    <head>
        <!-- Title -->
        <title>RFP Counter Demo</title>
        <!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- AngularJS -->
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
        <!-- Firebase -->
        <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
        <!-- AngularFire -->
        <script src="https://cdn.firebase.com/libs/angularfire/1.1.2/angularfire.min.js"></script>
        <!-- BootStrap -->
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <!-- Angular app -->
        <script>
            var app = angular.module("app", ["firebase"]);
            app.controller("RootCtrl", function($scope, $firebaseArray) {

                //Variables for example
                $scope.new1011 = {}
                $scope.tenTotal = {
                    value: 0
                }
                $scope.tenOnTheHour = {
                    time: "10am"
                }
                $scope.tenQuarterPast = {
                    time: "10.15am"
                }
                $scope.tenHalfPast = {
                    time: "10.30am"
                }
                $scope.tenQuarterToo = {
                    time: "10.45am"
                }
                $scope.elevenTotal = {
                    value: 0
                }
                $scope.elevenOnTheHour = {
                    time: "11am"
                }
                $scope.elevenQuarterPast = {
                    time: "11.15am"
                }
                $scope.elevenHalfPast = {
                    time: "11.30am"
                }
                $scope.elevenQuarterToo = {
                    time: "11.45am"
                }
                $scope.lockName = false;
                // Create firebase ref (INSERT OUR URL HERE)
                var dbURL = "https://rfpcards.firebaseio.com/"
                var ref = new Firebase(dbURL + '/RFPs/');
                // Bind (three-way)
                $scope.tickets = $firebaseArray(ref);

                // Add new chat message
                $scope.createTicket = function(){

                    // Add it to firebase db (and let the magic happen)
                    $scope.tickets.$add( $scope.new1011 );
                }

                $scope.deleteTicket = function(id){

                    ref.child(id).remove();
                }

                $scope.deleteAll = function() {
                    ref.remove();
                }

                $scope.createTicket10 = function(num){

                    var total = "" 
                    var input = num 
                    var segment = 4

                    var sum = input % segment

                    if (sum > 0) {
                        total = input - sum
                    }

                    if (sum == 0){
                        total = input
                    }

                    var equalQuarters = total / 4

                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.tenOnTheHour );
                    }
                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.tenQuarterPast );
                    }
                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.tenHalfPast );
                    }
                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.tenQuarterToo );
                    }

                }

                $scope.createTicket11 = function(num){

                    var total = "" 
                    var input = num 
                    var segment = 4

                    var sum = input % segment

                    if (sum > 0) {
                        total = input - sum
                    }

                    if (sum == 0){
                        total = input
                    }

                    var equalQuarters = total / 4

                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.elevenOnTheHour );
                    }
                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.elevenQuarterPast );
                    }
                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.elevenHalfPast );
                    }
                    // Create on the hours 
                    for (i = 0; i < equalQuarters; i++) {
                        $scope.tickets.$add( $scope.elevenQuarterToo );
                    }

                }

            });
        </script>

        <style>
            .smallText {
                font-size: 14px;
            }
            .navbar {
                -webkit-border-radius: 0;
                -moz-border-radius: 0;
                border-radius: 0;
            }

            /* The heart of the matter */
            .horizontalScroll > .row {
                overflow-y: hidden;
                overflow-x: scroll;
                -webkit-overflow-scrolling: touch;
                white-space: nowrap;
            }
            .horizontalScroll > .row > .col-xs-2 {
                display: inline-block;
                float: none;
            }

            /* Decorations 
            .col-xs-3 { color: #fff; padding-left: 0px; padding-right: 0px; padding-top: 10%}
            .col-xs-3:nth-child(8n+1) { background: rgb(0, 0, 255); }
            .col-xs-3:nth-child(8n+2) { background: rgb(0, 0, 240); }
            .col-xs-3:nth-child(8n+3) { background: rgb(0, 0, 225); }
            .col-xs-3:nth-child(8n+4) { background: rgb(0, 0, 210); }
            .col-xs-3:nth-child(8n+5) { background: rgb(0, 0, 195); }
            .col-xs-3:nth-child(8n+6) { background: rgb(0, 0, 170); }
            .col-xs-3:nth-child(8n+7) { background: rgb(0, 0, 145); }
            .col-xs-3:nth-child(8n+8) { background: rgb(0, 0, 120); }
            */

            .ticket {
                height: 50vh;
                padding-left: 0px; 
                padding-right: 0px;
                margin-left: 5px;
                margin-right: 5px;
                border-style: solid;
                border-width: 1px;
                
            }
            .ticketHead {
                background: rgb(0, 0, 255);
                height: 15%;
                color: white;
                padding-top: 10px;

            }
            .ticketBody {
                background-color: white;
                height: 70%;
            }
            .ticketFooter {
                height 15%;
                padding-top: 10px;
            }

        </style>
    </head>

    <body ng-controller="RootCtrl">

        <!-- Navbar -->
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span> 
                    </button>
                    <a class="navbar-brand" href="#">ï£¿</a>
                </div>
                <div class="collapse navbar-collapse" id="myNavbar">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#" id="Set" button data-toggle="modal" data-target="#myModal"><span class="glyphicon glyphicon-user"></span></button> Set Totals</a></li>
                </ul>
            </div>
        </div>
    </nav>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Set totals for the day</h4>
            </div>
            <div class="modal-body">
                <label>Total for 10-11:
                    <input type="number" name="input" ng-model="tenTotal.value"
                           min="4" max="99" required>
                </label>
                <br>
                <label>Total for 11-12:
                    <input type="number" name="input" ng-model="elevenTotal.value"
                           min="4" max="99" required>
                </label>

            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" 
                        ng-click="deleteAll();
                                  createTicket10(tenTotal.value); 
                                  createTicket11(elevenTotal.value)"
                        >Set Totals and Close</button>
            </div>
        </div>

    </div>
</div>

<div class="container-fluid text-center horizontalScroll">
    <div class="row">
        <div class="col-xs-2 ticket" ng-repeat="ticket in tickets">
            <div class="ticketHead">
                <strong>{{ticket.time}}</strong>
            </div>
            <div class="ticketBody">
                {{ticket.repairID}}  
            </div>
            <div class="ticketFooter">
                <button class="btn"ng-click="deleteTicket(ticket.$id)">Use</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>
